2025-09-10 07:30:32,539 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for data files: {'db.db'} (connection.py:316)
2025-09-10 07:30:33,671 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for in-memory database (connection.py:318)
2025-09-10 07:30:33,707 - MainThread - sqlmesh.core.config.connection - INFO - Using existing DuckDB adapter due to overlapping data file: db.db (connection.py:306)
2025-09-10 07:30:40,617 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema db.sqlmesh__sqlmesh_example (evaluator.py:323)
2025-09-10 07:30:40,623 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:2113)
2025-09-10 07:30:40,624 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:2113)
2025-09-10 07:30:40,626 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'db' AND table_schema = 'sqlmesh__sqlmesh_example') AND table_name IN ('sqlmesh_example__seed_model__2185867172', 'sqlmesh_example__raw_covid_data__277206641', 'sqlmesh_example__incremental_model__1880815781', 'sqlmesh_example__full_model__2278521865', 'sqlmesh_example__covid_analysis__717275060') (base.py:2113)
2025-09-10 07:30:40,663 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'db.sqlmesh__sqlmesh_example' (evaluator.py:1068)
2025-09-10 07:30:40,663 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "db"."sqlmesh__sqlmesh_example" (base.py:2113)
2025-09-10 07:30:40,670 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__raw_covid_data__277206641' (evaluator.py:1420)
2025-09-10 07:30:40,672 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__raw_covid_data__277206641" AS SELECT "country" AS "country", TRY_CAST(NULLIF("date", '') AS DATE) AS "date", TRY_CAST(NULLIF("total_cases", '') AS DOUBLE) AS "total_cases", TRY_CAST(NULLIF("new_cases", '') AS DOUBLE) AS "new_cases", TRY_CAST(NULLIF("new_cases_per_million", '') AS DOUBLE) AS "new_cases_per_million", TRY_CAST(NULLIF("new_deaths", '') AS DOUBLE) AS "new_deaths", TRY_CAST(NULLIF("new_deaths_per_million", '') AS DOUBLE) AS "new_deaths_per_million", TRY_CAST(NULLIF("people_vaccinated", '') AS DOUBLE) AS "people_vaccinated", TRY_CAST(NULLIF("people_fully_vaccinated", '') AS DOUBLE) AS "people_fully_vaccinated", TRY_CAST(NULLIF("total_boosters", '') AS DOUBLE) AS "total_boosters" FROM READ_CSV_AUTO('Data/OWID_COVID19_DATA.csv', "header" = TRUE, "all_varchar" = TRUE) AS "_q_0" WHERE NOT TRY_CAST(NULLIF("date", '') AS DATE) IS NULL AND FALSE LIMIT 0 (base.py:2113)
2025-09-10 07:30:40,901 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__covid_analysis__717275060' (evaluator.py:1420)
2025-09-10 07:30:40,902 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__covid_analysis__717275060" AS SELECT "raw_covid_data"."country" AS "location", "raw_covid_data"."date" AS "date", SUM("raw_covid_data"."new_cases") AS "total_cases", ROUND(AVG("raw_covid_data"."new_cases_per_million"), 2) AS "avg_inzidenz", SUM("raw_covid_data"."new_deaths") AS "total_deaths", ROUND(AVG("raw_covid_data"."new_deaths_per_million"), 2) AS "avg_todesrate", MAX("raw_covid_data"."people_fully_vaccinated") AS "max_vaccinated" FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__raw_covid_data__277206641" AS "raw_covid_data" WHERE "raw_covid_data"."date" >= '2020-01-01' AND FALSE GROUP BY "raw_covid_data"."country", "raw_covid_data"."date" ORDER BY "date" LIMIT 0 (base.py:2113)
2025-09-10 07:30:40,937 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"db"."sqlmesh_example"."raw_covid_data": 2164765397> (evaluator.py:595)
2025-09-10 07:30:40,943 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-09-07 00:00:00, 2025-09-08 00:00:00) into db.sqlmesh__sqlmesh_example.sqlmesh_example__raw_covid_data__277206641' (evaluator.py:649)
2025-09-10 07:30:40,943 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DESCRIBE "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__raw_covid_data__277206641" (base.py:2113)
2025-09-10 07:30:40,949 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE TABLE "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__raw_covid_data__277206641" AS SELECT CAST("country" AS TEXT) AS "country", CAST("date" AS DATE) AS "date", CAST("total_cases" AS DOUBLE) AS "total_cases", CAST("new_cases" AS DOUBLE) AS "new_cases", CAST("new_cases_per_million" AS DOUBLE) AS "new_cases_per_million", CAST("new_deaths" AS DOUBLE) AS "new_deaths", CAST("new_deaths_per_million" AS DOUBLE) AS "new_deaths_per_million", CAST("people_vaccinated" AS DOUBLE) AS "people_vaccinated", CAST("people_fully_vaccinated" AS DOUBLE) AS "people_fully_vaccinated", CAST("total_boosters" AS DOUBLE) AS "total_boosters" FROM (SELECT "country" AS "country", TRY_CAST(NULLIF("date", '') AS DATE) AS "date", TRY_CAST(NULLIF("total_cases", '') AS DOUBLE) AS "total_cases", TRY_CAST(NULLIF("new_cases", '') AS DOUBLE) AS "new_cases", TRY_CAST(NULLIF("new_cases_per_million", '') AS DOUBLE) AS "new_cases_per_million", TRY_CAST(NULLIF("new_deaths", '') AS DOUBLE) AS "new_deaths", TRY_CAST(NULLIF("new_deaths_per_million", '') AS DOUBLE) AS "new_deaths_per_million", TRY_CAST(NULLIF("people_vaccinated", '') AS DOUBLE) AS "people_vaccinated", TRY_CAST(NULLIF("people_fully_vaccinated", '') AS DOUBLE) AS "people_fully_vaccinated", TRY_CAST(NULLIF("total_boosters", '') AS DOUBLE) AS "total_boosters" FROM READ_CSV_AUTO('Data/OWID_COVID19_DATA.csv', "header" = TRUE, "all_varchar" = TRUE) AS "_q_0" WHERE NOT TRY_CAST(NULLIF("date", '') AS DATE) IS NULL) AS "_subquery" (base.py:2113)
2025-09-10 07:30:41,582 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-09-07 00:00:00, 2025-09-08 00:00:00) for snapshot SnapshotId<"db"."sqlmesh_example"."raw_covid_data": 2164765397> (facade.py:503)
2025-09-10 07:30:41,582 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"db"."sqlmesh_example"."raw_covid_data": 2164765397> (interval.py:210)
2025-09-10 07:30:41,596 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"db"."sqlmesh_example"."covid_analysis": 2341919857> (evaluator.py:595)
2025-09-10 07:30:41,603 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-09-07 00:00:00, 2025-09-08 00:00:00) into db.sqlmesh__sqlmesh_example.sqlmesh_example__covid_analysis__717275060' (evaluator.py:649)
2025-09-10 07:30:41,603 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DESCRIBE "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__covid_analysis__717275060" (base.py:2113)
2025-09-10 07:30:41,606 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE TABLE "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__covid_analysis__717275060" AS SELECT CAST("location" AS TEXT) AS "location", CAST("date" AS DATE) AS "date", CAST("total_cases" AS DOUBLE) AS "total_cases", CAST("avg_inzidenz" AS DOUBLE) AS "avg_inzidenz", CAST("total_deaths" AS DOUBLE) AS "total_deaths", CAST("avg_todesrate" AS DOUBLE) AS "avg_todesrate", CAST("max_vaccinated" AS DOUBLE) AS "max_vaccinated" FROM (SELECT "raw_covid_data"."country" AS "location", "raw_covid_data"."date" AS "date", SUM("raw_covid_data"."new_cases") AS "total_cases", ROUND(AVG("raw_covid_data"."new_cases_per_million"), 2) AS "avg_inzidenz", SUM("raw_covid_data"."new_deaths") AS "total_deaths", ROUND(AVG("raw_covid_data"."new_deaths_per_million"), 2) AS "avg_todesrate", MAX("raw_covid_data"."people_fully_vaccinated") AS "max_vaccinated" FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__raw_covid_data__277206641" AS "raw_covid_data" WHERE "raw_covid_data"."date" >= '2020-01-01' GROUP BY "raw_covid_data"."country", "raw_covid_data"."date" ORDER BY "date") AS "_subquery" (base.py:2113)
2025-09-10 07:30:41,939 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-09-07 00:00:00, 2025-09-08 00:00:00) for snapshot SnapshotId<"db"."sqlmesh_example"."covid_analysis": 2341919857> (facade.py:503)
2025-09-10 07:30:41,939 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"db"."sqlmesh_example"."covid_analysis": 2341919857> (interval.py:210)
2025-09-10 07:30:41,956 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Promoting environment 'prod' (facade.py:165)
2025-09-10 07:30:41,984 - MainThread - sqlmesh.core.state_sync.db.snapshot - INFO - Unpausing snapshot SnapshotId<"db"."sqlmesh_example"."covid_analysis": 2341919857> (snapshot.py:144)
2025-09-10 07:30:41,985 - MainThread - sqlmesh.core.state_sync.db.snapshot - INFO - Unpausing snapshot SnapshotId<"db"."sqlmesh_example"."raw_covid_data": 2164765397> (snapshot.py:144)
2025-09-10 07:30:41,990 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'db.sqlmesh_example' (evaluator.py:1068)
2025-09-10 07:30:41,990 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "db"."sqlmesh_example" (base.py:2113)
2025-09-10 07:30:41,990 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'db.sqlmesh_example.raw_covid_data' to point at table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__raw_covid_data__277206641' (evaluator.py:1375)
2025-09-10 07:30:41,991 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "db"."sqlmesh_example"."raw_covid_data" AS SELECT * FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__raw_covid_data__277206641" (base.py:2113)
2025-09-10 07:30:41,993 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'db.sqlmesh_example.covid_analysis' to point at table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__covid_analysis__717275060' (evaluator.py:1375)
2025-09-10 07:30:41,994 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "db"."sqlmesh_example"."covid_analysis" AS SELECT * FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__covid_analysis__717275060" (base.py:2113)
2025-09-10 07:30:41,996 - MainThread - sqlmesh.core.state_sync.db.environment - INFO - Finalizing environment 'prod' (environment.py:135)
2025-09-10 07:30:42,032 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
