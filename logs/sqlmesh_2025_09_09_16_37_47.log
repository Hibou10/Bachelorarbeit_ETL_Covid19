2025-09-09 16:37:47,370 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for data files: {'db.db'} (connection.py:316)
2025-09-09 16:37:48,313 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for in-memory database (connection.py:318)
2025-09-09 16:37:48,348 - MainThread - sqlmesh.core.config.connection - INFO - Using existing DuckDB adapter due to overlapping data file: db.db (connection.py:306)
2025-09-09 16:39:02,890 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema db.sqlmesh__sqlmesh_example (evaluator.py:323)
2025-09-09 16:39:02,895 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:2113)
2025-09-09 16:39:02,896 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:2113)
2025-09-09 16:39:02,897 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'db' AND table_schema = 'sqlmesh__sqlmesh_example') AND table_name IN ('sqlmesh_example__full_model__2278521865', 'sqlmesh_example__incremental_model__1880815781', 'sqlmesh_example__covid_analysis__3983447452', 'sqlmesh_example__raw_covid_data__2711646111', 'sqlmesh_example__seed_model__2185867172') (base.py:2113)
2025-09-09 16:39:02,938 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'db.sqlmesh__sqlmesh_example' (evaluator.py:1068)
2025-09-09 16:39:02,938 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "db"."sqlmesh__sqlmesh_example" (base.py:2113)
2025-09-09 16:39:02,947 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__covid_analysis__3983447452' (evaluator.py:1420)
2025-09-09 16:39:02,948 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__covid_analysis__3983447452" AS SELECT "raw_covid_data"."country" AS "location", "raw_covid_data"."date" AS "date", SUM("raw_covid_data"."new_cases") AS "total_cases", ROUND(AVG("raw_covid_data"."new_cases_per_million"), 2) AS "avg_inzidenz", SUM("raw_covid_data"."new_deaths") AS "total_deaths", ROUND(AVG("raw_covid_data"."new_deaths_per_million"), 2) AS "avg_todesrate", MAX("raw_covid_data"."people_fully_vaccinated") AS "max_vaccinated" FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__raw_covid_data__2711646111" AS "raw_covid_data" WHERE "raw_covid_data"."date" >= '2020-01-01' AND FALSE GROUP BY "raw_covid_data"."country", "raw_covid_data"."date" ORDER BY "date" LIMIT 0 (base.py:2113)
2025-09-09 16:39:02,986 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"db"."sqlmesh_example"."covid_analysis": 3334679012> (evaluator.py:595)
2025-09-09 16:39:02,993 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-09-07 00:00:00, 2025-09-08 00:00:00) into db.sqlmesh__sqlmesh_example.sqlmesh_example__covid_analysis__3983447452' (evaluator.py:649)
2025-09-09 16:39:02,993 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DESCRIBE "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__covid_analysis__3983447452" (base.py:2113)
2025-09-09 16:39:02,996 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE TABLE "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__covid_analysis__3983447452" AS SELECT CAST("location" AS TEXT) AS "location", CAST("date" AS DATE) AS "date", CAST("total_cases" AS DOUBLE) AS "total_cases", CAST("avg_inzidenz" AS DOUBLE) AS "avg_inzidenz", CAST("total_deaths" AS DOUBLE) AS "total_deaths", CAST("avg_todesrate" AS DOUBLE) AS "avg_todesrate", CAST("max_vaccinated" AS DOUBLE) AS "max_vaccinated" FROM (SELECT "raw_covid_data"."country" AS "location", "raw_covid_data"."date" AS "date", SUM("raw_covid_data"."new_cases") AS "total_cases", ROUND(AVG("raw_covid_data"."new_cases_per_million"), 2) AS "avg_inzidenz", SUM("raw_covid_data"."new_deaths") AS "total_deaths", ROUND(AVG("raw_covid_data"."new_deaths_per_million"), 2) AS "avg_todesrate", MAX("raw_covid_data"."people_fully_vaccinated") AS "max_vaccinated" FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__raw_covid_data__2711646111" AS "raw_covid_data" WHERE "raw_covid_data"."date" >= '2020-01-01' GROUP BY "raw_covid_data"."country", "raw_covid_data"."date" ORDER BY "date") AS "_subquery" (base.py:2113)
2025-09-09 16:39:03,344 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-09-07 00:00:00, 2025-09-08 00:00:00) for snapshot SnapshotId<"db"."sqlmesh_example"."covid_analysis": 3334679012> (facade.py:503)
2025-09-09 16:39:03,345 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"db"."sqlmesh_example"."covid_analysis": 3334679012> (interval.py:210)
2025-09-09 16:39:03,361 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Promoting environment 'prod' (facade.py:165)
2025-09-09 16:39:03,382 - MainThread - sqlmesh.core.state_sync.db.snapshot - INFO - Unpausing snapshot SnapshotId<"db"."sqlmesh_example"."covid_analysis": 3334679012> (snapshot.py:144)
2025-09-09 16:39:03,387 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'db.sqlmesh_example' (evaluator.py:1068)
2025-09-09 16:39:03,387 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "db"."sqlmesh_example" (base.py:2113)
2025-09-09 16:39:03,388 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'db.sqlmesh_example.covid_analysis' to point at table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__covid_analysis__3983447452' (evaluator.py:1375)
2025-09-09 16:39:03,388 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "db"."sqlmesh_example"."covid_analysis" AS SELECT * FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__covid_analysis__3983447452" (base.py:2113)
2025-09-09 16:39:03,391 - MainThread - sqlmesh.core.state_sync.db.environment - INFO - Finalizing environment 'prod' (environment.py:135)
2025-09-09 16:39:03,423 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
