2025-09-08 14:24:38,801 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for data files: {'db.db'} (connection.py:316)
2025-09-08 14:24:40,182 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for in-memory database (connection.py:318)
2025-09-08 14:24:40,222 - MainThread - sqlmesh.core.config.connection - INFO - Using existing DuckDB adapter due to overlapping data file: db.db (connection.py:306)
2025-09-08 14:25:38,899 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema db.sqlmesh__sqlmesh_example (evaluator.py:323)
2025-09-08 14:25:38,904 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:2113)
2025-09-08 14:25:38,905 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:2113)
2025-09-08 14:25:38,906 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'db' AND table_schema = 'sqlmesh__sqlmesh_example') AND table_name IN ('sqlmesh_example__seed_model__2185867172', 'sqlmesh_example__covid_analysis__1226997672', 'sqlmesh_example__full_model__2278521865', 'sqlmesh_example__raw_covid_data__2711646111', 'sqlmesh_example__incremental_model__1880815781') (base.py:2113)
2025-09-08 14:25:38,942 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'db.sqlmesh__sqlmesh_example' (evaluator.py:1068)
2025-09-08 14:25:38,943 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "db"."sqlmesh__sqlmesh_example" (base.py:2113)
2025-09-08 14:25:38,950 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__covid_analysis__1226997672' (evaluator.py:1420)
2025-09-08 14:25:38,951 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__covid_analysis__1226997672" AS SELECT "raw_covid_data"."country" AS "location", "raw_covid_data"."date" AS "date", ROUND(AVG("raw_covid_data"."new_cases_per_million"), 2) AS "avg_inzidenz", ROUND(AVG("raw_covid_data"."new_deaths_per_million"), 2) AS "avg_todesrate", MAX("raw_covid_data"."people_fully_vaccinated") AS "max_vaccinated" FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__raw_covid_data__2711646111" AS "raw_covid_data" WHERE "raw_covid_data"."date" >= '2020-01-01' AND FALSE GROUP BY "raw_covid_data"."country", "raw_covid_data"."date" ORDER BY "date" LIMIT 0 (base.py:2113)
2025-09-08 14:25:38,989 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"db"."sqlmesh_example"."raw_covid_data": 2795401186> (evaluator.py:595)
2025-09-08 14:25:38,994 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-09-07 00:00:00, 2025-09-08 00:00:00) into db.sqlmesh__sqlmesh_example.sqlmesh_example__raw_covid_data__2711646111' (evaluator.py:649)
2025-09-08 14:25:38,994 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DESCRIBE "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__raw_covid_data__2711646111" (base.py:2113)
2025-09-08 14:25:38,999 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE TABLE "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__raw_covid_data__2711646111" AS SELECT CAST("country" AS TEXT) AS "country", CAST("date" AS DATE) AS "date", CAST("total_cases" AS DOUBLE) AS "total_cases", CAST("new_cases" AS DOUBLE) AS "new_cases", CAST("new_cases_per_million" AS DOUBLE) AS "new_cases_per_million", CAST("new_deaths" AS DOUBLE) AS "new_deaths", CAST("new_deaths_per_million" AS DOUBLE) AS "new_deaths_per_million", CAST("people_vaccinated" AS DOUBLE) AS "people_vaccinated", CAST("people_fully_vaccinated" AS DOUBLE) AS "people_fully_vaccinated", CAST("total_boosters" AS DOUBLE) AS "total_boosters" FROM (SELECT "country" AS "country", TRY_CAST("date" AS DATE) AS "date", TRY_CAST("total_cases" AS DOUBLE) AS "total_cases", TRY_CAST("new_cases" AS DOUBLE) AS "new_cases", TRY_CAST("new_cases_per_million" AS DOUBLE) AS "new_cases_per_million", TRY_CAST("new_deaths" AS DOUBLE) AS "new_deaths", TRY_CAST("new_deaths_per_million" AS DOUBLE) AS "new_deaths_per_million", TRY_CAST("people_vaccinated" AS DOUBLE) AS "people_vaccinated", TRY_CAST("people_fully_vaccinated" AS DOUBLE) AS "people_fully_vaccinated", TRY_CAST("total_boosters" AS DOUBLE) AS "total_boosters" FROM READ_CSV_AUTO('Data/OWID_COVID19_DATA.csv', "header" = TRUE, "all_varchar" = TRUE) AS "_q_0") AS "_subquery" (base.py:2113)
2025-09-08 14:25:39,634 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-09-07 00:00:00, 2025-09-08 00:00:00) for snapshot SnapshotId<"db"."sqlmesh_example"."raw_covid_data": 2795401186> (facade.py:503)
2025-09-08 14:25:39,634 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"db"."sqlmesh_example"."raw_covid_data": 2795401186> (interval.py:210)
2025-09-08 14:25:39,650 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"db"."sqlmesh_example"."covid_analysis": 365463728> (evaluator.py:595)
2025-09-08 14:25:39,654 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-09-07 00:00:00, 2025-09-08 00:00:00) into db.sqlmesh__sqlmesh_example.sqlmesh_example__covid_analysis__1226997672' (evaluator.py:649)
2025-09-08 14:25:39,655 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DESCRIBE "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__covid_analysis__1226997672" (base.py:2113)
2025-09-08 14:25:39,657 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE TABLE "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__covid_analysis__1226997672" AS SELECT CAST("location" AS TEXT) AS "location", CAST("date" AS DATE) AS "date", CAST("avg_inzidenz" AS DOUBLE) AS "avg_inzidenz", CAST("avg_todesrate" AS DOUBLE) AS "avg_todesrate", CAST("max_vaccinated" AS DOUBLE) AS "max_vaccinated" FROM (SELECT "raw_covid_data"."country" AS "location", "raw_covid_data"."date" AS "date", ROUND(AVG("raw_covid_data"."new_cases_per_million"), 2) AS "avg_inzidenz", ROUND(AVG("raw_covid_data"."new_deaths_per_million"), 2) AS "avg_todesrate", MAX("raw_covid_data"."people_fully_vaccinated") AS "max_vaccinated" FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__raw_covid_data__2711646111" AS "raw_covid_data" WHERE "raw_covid_data"."date" >= '2020-01-01' GROUP BY "raw_covid_data"."country", "raw_covid_data"."date" ORDER BY "date") AS "_subquery" (base.py:2113)
2025-09-08 14:25:39,952 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-09-07 00:00:00, 2025-09-08 00:00:00) for snapshot SnapshotId<"db"."sqlmesh_example"."covid_analysis": 365463728> (facade.py:503)
2025-09-08 14:25:39,952 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"db"."sqlmesh_example"."covid_analysis": 365463728> (interval.py:210)
2025-09-08 14:25:39,973 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Promoting environment 'prod' (facade.py:165)
2025-09-08 14:25:39,997 - MainThread - sqlmesh.core.state_sync.db.snapshot - INFO - Unpausing snapshot SnapshotId<"db"."sqlmesh_example"."covid_analysis": 365463728> (snapshot.py:144)
2025-09-08 14:25:39,998 - MainThread - sqlmesh.core.state_sync.db.snapshot - INFO - Unpausing snapshot SnapshotId<"db"."sqlmesh_example"."raw_covid_data": 2795401186> (snapshot.py:144)
2025-09-08 14:25:40,005 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'db.sqlmesh_example' (evaluator.py:1068)
2025-09-08 14:25:40,005 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "db"."sqlmesh_example" (base.py:2113)
2025-09-08 14:25:40,006 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'db.sqlmesh_example.raw_covid_data' to point at table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__raw_covid_data__2711646111' (evaluator.py:1375)
2025-09-08 14:25:40,007 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "db"."sqlmesh_example"."raw_covid_data" AS SELECT * FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__raw_covid_data__2711646111" (base.py:2113)
2025-09-08 14:25:40,009 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'db.sqlmesh_example.covid_analysis' to point at table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__covid_analysis__1226997672' (evaluator.py:1375)
2025-09-08 14:25:40,010 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "db"."sqlmesh_example"."covid_analysis" AS SELECT * FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__covid_analysis__1226997672" (base.py:2113)
2025-09-08 14:25:40,012 - MainThread - sqlmesh.core.state_sync.db.environment - INFO - Finalizing environment 'prod' (environment.py:135)
2025-09-08 14:25:40,048 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
