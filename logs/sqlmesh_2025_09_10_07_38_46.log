2025-09-10 07:38:46,951 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for data files: {'db.db'} (connection.py:316)
2025-09-10 07:38:47,740 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for in-memory database (connection.py:318)
2025-09-10 07:38:47,776 - MainThread - sqlmesh.core.config.connection - INFO - Using existing DuckDB adapter due to overlapping data file: db.db (connection.py:306)
2025-09-10 07:38:50,291 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema db.sqlmesh__sqlmesh_example (evaluator.py:323)
2025-09-10 07:38:50,296 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:2113)
2025-09-10 07:38:50,297 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:2113)
2025-09-10 07:38:50,298 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'db' AND table_schema = 'sqlmesh__sqlmesh_example') AND table_name IN ('sqlmesh_example__full_model__2278521865', 'sqlmesh_example__incremental_model__1880815781', 'sqlmesh_example__seed_model__2185867172', 'sqlmesh_example__raw_covid_data__277206641', 'sqlmesh_example__covid_analysis__2955718152') (base.py:2113)
2025-09-10 07:38:50,326 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'db.sqlmesh__sqlmesh_example' (evaluator.py:1068)
2025-09-10 07:38:50,326 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "db"."sqlmesh__sqlmesh_example" (base.py:2113)
2025-09-10 07:38:50,336 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__covid_analysis__2955718152' (evaluator.py:1420)
2025-09-10 07:38:50,337 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__covid_analysis__2955718152" AS SELECT "raw_covid_data"."country" AS "location", "raw_covid_data"."date" AS "date", SUM(COALESCE("raw_covid_data"."new_cases", 0)) AS "total_cases", ROUND(AVG(COALESCE("raw_covid_data"."new_cases_per_million", 0)), 2) AS "avg_inzidenz", SUM(COALESCE("raw_covid_data"."new_deaths", 0)) AS "total_deaths", ROUND(AVG(COALESCE("raw_covid_data"."new_deaths_per_million", 0)), 2) AS "avg_todesrate", MAX(COALESCE("raw_covid_data"."people_fully_vaccinated", 0)) AS "max_vaccinated" FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__raw_covid_data__277206641" AS "raw_covid_data" WHERE "raw_covid_data"."date" >= '2020-01-01' AND FALSE GROUP BY "raw_covid_data"."country", "raw_covid_data"."date" ORDER BY "date" LIMIT 0 (base.py:2113)
2025-09-10 07:38:50,369 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"db"."sqlmesh_example"."covid_analysis": 4215504825> (evaluator.py:595)
2025-09-10 07:38:50,376 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-09-07 00:00:00, 2025-09-08 00:00:00) into db.sqlmesh__sqlmesh_example.sqlmesh_example__covid_analysis__2955718152' (evaluator.py:649)
2025-09-10 07:38:50,376 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DESCRIBE "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__covid_analysis__2955718152" (base.py:2113)
2025-09-10 07:38:50,379 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE TABLE "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__covid_analysis__2955718152" AS SELECT CAST("location" AS TEXT) AS "location", CAST("date" AS DATE) AS "date", CAST("total_cases" AS DOUBLE) AS "total_cases", CAST("avg_inzidenz" AS DOUBLE) AS "avg_inzidenz", CAST("total_deaths" AS DOUBLE) AS "total_deaths", CAST("avg_todesrate" AS DOUBLE) AS "avg_todesrate", CAST("max_vaccinated" AS DOUBLE) AS "max_vaccinated" FROM (SELECT "raw_covid_data"."country" AS "location", "raw_covid_data"."date" AS "date", SUM(COALESCE("raw_covid_data"."new_cases", 0)) AS "total_cases", ROUND(AVG(COALESCE("raw_covid_data"."new_cases_per_million", 0)), 2) AS "avg_inzidenz", SUM(COALESCE("raw_covid_data"."new_deaths", 0)) AS "total_deaths", ROUND(AVG(COALESCE("raw_covid_data"."new_deaths_per_million", 0)), 2) AS "avg_todesrate", MAX(COALESCE("raw_covid_data"."people_fully_vaccinated", 0)) AS "max_vaccinated" FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__raw_covid_data__277206641" AS "raw_covid_data" WHERE "raw_covid_data"."date" >= '2020-01-01' GROUP BY "raw_covid_data"."country", "raw_covid_data"."date" ORDER BY "date") AS "_subquery" (base.py:2113)
2025-09-10 07:38:50,722 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-09-07 00:00:00, 2025-09-08 00:00:00) for snapshot SnapshotId<"db"."sqlmesh_example"."covid_analysis": 4215504825> (facade.py:503)
2025-09-10 07:38:50,722 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"db"."sqlmesh_example"."covid_analysis": 4215504825> (interval.py:210)
2025-09-10 07:38:50,739 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Promoting environment 'prod' (facade.py:165)
2025-09-10 07:38:50,761 - MainThread - sqlmesh.core.state_sync.db.snapshot - INFO - Unpausing snapshot SnapshotId<"db"."sqlmesh_example"."covid_analysis": 4215504825> (snapshot.py:144)
2025-09-10 07:38:50,767 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'db.sqlmesh_example' (evaluator.py:1068)
2025-09-10 07:38:50,767 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "db"."sqlmesh_example" (base.py:2113)
2025-09-10 07:38:50,768 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'db.sqlmesh_example.covid_analysis' to point at table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__covid_analysis__2955718152' (evaluator.py:1375)
2025-09-10 07:38:50,768 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "db"."sqlmesh_example"."covid_analysis" AS SELECT * FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__covid_analysis__2955718152" (base.py:2113)
2025-09-10 07:38:50,772 - MainThread - sqlmesh.core.state_sync.db.environment - INFO - Finalizing environment 'prod' (environment.py:135)
2025-09-10 07:38:50,810 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
